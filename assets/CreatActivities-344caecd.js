import{u as w,r as i,j as e,L as b,B as v,b as j}from"./index-bcedf953.js";import{F as y}from"./Footer-b221c0b5.js";import{S as p,T as N}from"./TiptapEdit-80030389.js";import{S as l}from"./sweetalert2.all-b0b18555.js";import{i as C}from"./browser-image-compression-a3ab6596.js";import{L as k}from"./index-90ce958f.js";import{L}from"./loader-2-4d2d1e12.js";import"./BalaodWhiteOutFull@3x-b5c97ecf.js";import"./styles-6595e448.js";const z=()=>{const h=w(),[c,r]=i.useState(!1),[t,s]=i.useState(JSON.parse(localStorage.getItem("saveEdit")||"")),[d,f]=i.useState(null),u=async o=>{const a=o.target.files[0];if(a){const n=URL.createObjectURL(a),g=await x(a);f(n),s({...t,photo:g})}},x=async o=>await C(o,{maxSizeMB:1,maxWidthOrHeight:2048,useWebWorker:!0,fileType:"image/webp"});i.useEffect(()=>{localStorage.setItem("saveEdit",JSON.stringify(t))},[t]);function m(o){return!o.title||!o.content||!o.photo.name}return e.jsxs("div",{className:" min-h-0 w-full max-w-full  flex flex-col justify-center",children:[e.jsxs("div",{className:" relative w-full flex  justify-center items-center h-[60vh] bg-black overflow-hidden",children:[e.jsx("div",{className:" cursor-pointer z-20 absolute grid w-full max-w-xs items-center gap-1.5",children:e.jsx("input",{id:"picture",className:" cursor-pointer flex h-10 w-full rounded-md border border-input bg-white px-3 py-2 text-sm text-gray-400 file:border-0 file:bg-transparent file:text-gray-600 file:text-sm file:font-medium",required:!0,placeholder:"Photo",type:"file",onChange:u})}),d&&e.jsx("img",{src:d,className:" relative w-full mt-5 text-xl mb-5 object-cover h-[60vh]",alt:""})]}),e.jsxs("div",{className:" mt-5 px-[10vw] md:px-5",children:[e.jsxs(b,{to:"/balaod/editable/kudlit",className:" w-[90px] font-fmedium flex items-center justify-between px-2 py-2 bg-background text-black font-bold border border-gray-300 hover:bg-[#e4e4e4]",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})}),"Kudlit"]}),e.jsxs("div",{className:" flex justify-between border border-x-0 py-5 text-base font-fmedium mt-4 ",children:[e.jsxs("div",{className:" flex items-center gap-4",children:[e.jsx("input",{value:t.date,onChange:o=>{s({...t,date:o.target.value})},className:" text-right border border-border",type:"date"}),e.jsx(p,{checked:t.showDate,onCheckedChange:o=>{s({...t,showDate:o})}})]}),e.jsxs("div",{className:" flex items-center gap-4",children:[e.jsx("input",{value:t.location,onChange:o=>{s({...t,location:o.target.value})},placeholder:" Cagayan de Oro, 9000",type:"text",className:" w-[400px] text-right border border-border"}),e.jsx(k,{className:" h-4 w-4"}),e.jsx(p,{checked:t.showLocation,onCheckedChange:o=>{s({...t,showLocation:o})}})]})]}),e.jsxs("div",{className:" flex flex-col  mt-5 font-fmedium text-lg gap-5 mb-36",children:[e.jsx("div",{children:e.jsx("textarea",{value:t.title,onChange:o=>{s({...t,title:o.target.value})},required:!0,className:" w-full outline-none text-primary text-3xl font-fbold",placeholder:"Title e.g Community Engagement: Local Citizens Participate in Process "})}),e.jsx(N,{data:t.content,setData:s}),e.jsxs(v,{className:c?" font-fbold pointer-events-none flex gap-3 ":" font-fbold pointer-events-auto",onClick:async o=>{if(o.preventDefault(),console.log(m(t)),m(t))l.fire({title:"Empty Field (Photo,title,content)!",text:"Some Fields are Empty please fill it up",icon:"error",showConfirmButton:!1,timer:2e3});else{r(!0);const a=new FormData;a.append("title",t.title),a.append("content",t.content),a.append("photo",t.photo),a.append("location",t.location),a.append("date",t.date),a.append("showDate",t.showDate),a.append("showLocation",t.showLocation);try{await j.post("posting/activity/addActivity/",a,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`,"Content-Type":"multipart/form-data"}}).then(n=>{r(!1),l.fire({title:"Added!",text:"The new Activity has been Added",icon:"success",showConfirmButton:!1,timer:2e3}),s({title:"",content:"",highlight:!1,photo:null,location:"",date:null,showDate:!0,showLocation:!0}),localStorage.setItem("saveEdit",JSON.stringify({title:"",content:"",highlight:!1,photo:{},location:"",date:null,showDate:!0,showLocation:!0})),h("/balaod/editable/kudlit")})}catch{l.fire({title:"Error",text:"Something is wrong, please contact the creator",icon:"error",showConfirmButton:!1,timer:2e3})}setTimeout(()=>{r(!1)},5e3)}},children:["  ",e.jsx(L,{className:c?" animate-spin ":" hidden"})," Publish Blog"]})]})]}),e.jsx(y,{})]})};export{z as default};
